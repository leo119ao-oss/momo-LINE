(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[379],{4249:function(e,n,t){Promise.resolve().then(t.bind(t,3133))},3133:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return f}});var i=t(7437),r=t(2265),l=t(4234),s=t(7119);let o=s.Ry({url:s.Z_().url(),title:s.Z_().nullable().optional(),why:s.Z_().min(3).max(120)}),a=s.Ry({type:s.i0("recommendations"),items:s.IX(o).length(3),rev:s.Z_().min(3)}),d=s.Ry({type:s.i0("confirm"),message:s.Z_().min(5),options:s.IX(s.Z_()).min(2),freeTextHint:s.Z_().optional(),rev:s.Z_().min(3)});function c(e){let{contact:n}=e,[t,l]=(0,r.useState)(""),[s,o]=(0,r.useState)(null),[c,u]=(0,r.useState)(!1);async function f(e){u(!0);let n=await fetch("/api/ask",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(e)}),t=await n.json();u(!1),d.safeParse(t).success?o(t):a.safeParse(t).success?o(t):o(null)}return(0,i.jsxs)("div",{style:{marginTop:14,border:"1px solid #eee",borderRadius:12,padding:12},children:[(0,i.jsx)("div",{style:{fontSize:13,color:"#444",marginBottom:6},children:"困ったときの質問（任意）"}),(0,i.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,i.jsx)("input",{value:t,onChange:e=>l(e.target.value),placeholder:"例：子どもの朝食が大変で…",style:{flex:1,border:"1px solid #ddd",borderRadius:8,padding:"10px 12px"}}),(0,i.jsx)("button",{onClick:()=>f({contact:n,q:t}),disabled:!t||c,style:p,children:"聞く"})]}),c&&(0,i.jsx)("p",{style:{fontSize:12,color:"#999",marginTop:8},children:"検索中…"}),s&&"type"in s&&"confirm"===s.type&&(0,i.jsxs)("div",{style:{marginTop:10},children:[(0,i.jsx)("p",{style:{margin:"6px 0"},children:s.message}),(0,i.jsx)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:s.options.map(e=>(0,i.jsx)("button",{onClick:()=>f({contact:n,q:t+" "+e}),style:x,children:e},e))}),s.freeTextHint&&(0,i.jsx)("p",{style:{fontSize:12,color:"#888",marginTop:6},children:s.freeTextHint})]}),s&&"type"in s&&"recommendations"===s.type&&(0,i.jsxs)("div",{style:{marginTop:10},children:[(0,i.jsx)("p",{style:{fontSize:13,color:"#666",marginBottom:8},children:"おすすめ（3件＋理由）"}),(0,i.jsx)("ul",{style:{display:"grid",gap:8},children:s.items.map((e,n)=>{var t;return(0,i.jsxs)("li",{style:{border:"1px solid #eee",borderRadius:10,padding:10},children:[(0,i.jsx)("a",{href:e.url,target:"_blank",style:{fontWeight:600,textDecoration:"none",color:"#333"},children:null!==(t=e.title)&&void 0!==t?t:"リンク"}),(0,i.jsxs)("div",{style:{fontSize:12,color:"#666",marginTop:4},children:["理由：",e.why]})]},n)})})]})]})}let p={background:"#FF8FA3",color:"#fff",border:"none",padding:"10px 14px",borderRadius:10,fontWeight:700},x={padding:"6px 10px",borderRadius:999,border:"1px solid #ddd",background:"#FFEEF2",color:"#D33"};var u=t(257);function f(){let[e,n]=(0,r.useState)(),[t,s]=(0,r.useState)(5),[o,a]=(0,r.useState)(5),[d,p]=(0,r.useState)(5),[x,f]=(0,r.useState)("家事"),[m,w]=(0,r.useState)("");async function _(){if(!e)return;let n=await fetch("/api/daily",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({contact:e,mood:t,load:o,efficacy:d,choice:x,memo:m})});n.ok?(alert("今日の1分を送信しました。おつかれさま！"),history.back()):alert("送信エラー："+await n.text())}return((0,r.useEffect)(()=>{(async()=>{await (0,l.M)(u.env.NEXT_PUBLIC_LIFF_DAILY_ID),n(await (0,l.C)())})()},[]),e)?(0,i.jsxs)(h,{children:[(0,i.jsx)("h1",{style:b,children:"今日の1分"}),(0,i.jsxs)("p",{style:{margin:"4px 0 12px",color:"#666"},children:["スライダーを動かして、最後に一言。",(0,i.jsx)("b",{children:"60秒で終わります。"})]}),(0,i.jsxs)("div",{style:v,children:[(0,i.jsx)(y,{label:"気分",value:t,onChange:s,left:"低い",right:"高い"}),(0,i.jsx)(y,{label:"負担",value:o,onChange:a,left:"軽い",right:"重い"}),(0,i.jsx)(y,{label:"自信",value:d,onChange:p,left:"低い",right:"高い"}),(0,i.jsx)(g,{label:"今日のトピック（選択）",children:(0,i.jsx)(j,{options:["家事","育児","仕事","体調","自分時間"],value:x,onChange:f})}),(0,i.jsxs)(g,{label:"ひとこと（80字まで）",children:[(0,i.jsx)("textarea",{value:m,onChange:e=>w(e.target.value.slice(0,80)),placeholder:"例：寝かしつけで助けてもらえて楽だった",style:F}),(0,i.jsxs)("div",{style:{textAlign:"right",fontSize:12,color:"#999"},children:[m.length,"/80"]})]}),(0,i.jsx)("button",{onClick:_,style:S,children:"送信する"})]}),(0,i.jsx)("p",{style:{fontSize:12,color:"#666"},children:"※必要な時だけ、後続で「確認の質問」や「記事3件」が出ます。"}),(0,i.jsx)(c,{contact:e})]}):(0,i.jsx)(h,{children:(0,i.jsx)("p",{children:"読み込み中…"})})}function h(e){let{children:n}=e;return(0,i.jsxs)("main",{style:{maxWidth:560,margin:"0 auto",padding:"20px 16px"},children:[(0,i.jsx)("div",{style:m,children:"momo 研究モード"}),n]})}function g(e){let{label:n,children:t}=e;return(0,i.jsxs)("div",{style:{margin:"12px 0"},children:[(0,i.jsx)("div",{style:{fontSize:13,color:"#444",marginBottom:6},children:n}),t]})}function y(e){let{label:n,value:t,onChange:r,left:l,right:s}=e;return(0,i.jsxs)("div",{style:{margin:"12px 0"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13,color:"#444"},children:[(0,i.jsx)("span",{children:n}),(0,i.jsx)("span",{children:t})]}),(0,i.jsx)("input",{type:"range",min:0,max:10,value:t,onChange:e=>r(Number(e.target.value)),style:{width:"100%"}}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:12,color:"#888"},children:[(0,i.jsx)("span",{children:l}),(0,i.jsx)("span",{children:s})]})]})}function j(e){let{options:n,value:t,onChange:r}=e;return(0,i.jsx)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:n.map(e=>(0,i.jsx)("button",{onClick:()=>r(e),style:{padding:"6px 10px",borderRadius:999,border:"1px solid #ddd",background:t===e?"#FFEEF2":"#fff",color:t===e?"#D33":"#333"},children:e},e))})}let m={background:"#FFF0F4",color:"#FF6F91",padding:"8px 12px",borderRadius:10,fontSize:12,textAlign:"center",marginBottom:12},b={fontSize:22,fontWeight:700,margin:"4px 0 8px"},v={background:"#fff",border:"1px solid #eee",borderRadius:12,padding:16},S={marginTop:8,width:"100%",background:"#FF8FA3",color:"#fff",border:"none",padding:"12px",borderRadius:10,fontWeight:700,fontSize:16},F={width:"100%",height:80,border:"1px solid #ddd",borderRadius:8,padding:"10px 12px",fontSize:16}},4234:function(e,n,t){"use strict";t.d(n,{C:function(){return l},M:function(){return r}});var i=t(1571);async function r(e){i.Z.isLoggedIn()||await i.Z.init({liffId:e})}async function l(){return(await i.Z.getProfile()).userId}}},function(e){e.O(0,[370,119,971,117,744],function(){return e(e.s=4249)}),_N_E=e.O()}]);