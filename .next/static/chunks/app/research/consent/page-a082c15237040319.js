(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[620],{4920:function(e,t,s){Promise.resolve().then(s.bind(s,2836))},9376:function(e,t,s){"use strict";var n=s(5475);s.o(n,"notFound")&&s.d(t,{notFound:function(){return n.notFound}}),s.o(n,"useRouter")&&s.d(t,{useRouter:function(){return n.useRouter}})},2836:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var n=s(7437),a=s(2265),r=s(9376),l=s(4234),i=s(257);function o(){let[e,t]=(0,a.useState)(),[s,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(""),[u,m]=(0,a.useState)("community"),[h,x]=(0,a.useState)(!1),[b,p]=(0,a.useState)(null),[g,f]=(0,a.useState)({stress:5,support:5,confidence:5}),N=(0,r.useRouter)();(0,a.useEffect)(()=>{(async()=>{try{let e=i.env.NEXT_PUBLIC_LIFF_CONSENT_ID||"2008112810-zeKELwrx";console.log("[CONSENT] LIFF ID: ".concat(e)),await (0,l.M)(e),t(await (0,l.C)())}catch(e){console.error("[CONSENT] LIFF initialization error:",e)}})()},[]);let y=async t=>{if(t.preventDefault(),s&&c&&e){x(!0);try{let t=await fetch("/api/consent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({display_name:c,contact:e,cohort:u})});if(t.ok){let e=await t.json();p(e.participant),localStorage.setItem("participant",JSON.stringify(e.participant))}else alert("同意の送信に失敗しました。")}catch(e){alert("エラーが発生しました。")}finally{x(!1)}}},j=async e=>{if(e.preventDefault(),b){x(!0);try{(await fetch("/api/survey/pre",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:b.id,answers:g,minutes:2})})).ok?N.push("/"):alert("アンケートの送信に失敗しました。")}catch(e){alert("エラーが発生しました。")}finally{x(!1)}}};return e?b?(0,n.jsxs)("div",{className:"max-w-md mx-auto p-6 bg-white rounded-lg shadow-md",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"開始前アンケート"}),(0,n.jsxs)("p",{className:"text-sm text-gray-600 mb-6",children:["研究にご参加いただき、ありがとうございます。",(0,n.jsx)("br",{}),"割付: ","minimal"===b.condition?"基本版":"拡張版"]}),(0,n.jsxs)("form",{onSubmit:j,className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["ストレスレベル: ",g.stress,"/10"]}),(0,n.jsx)("input",{type:"range",min:"0",max:"10",value:g.stress,onChange:e=>f(t=>({...t,stress:Number(e.target.value)})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["サポート感: ",g.support,"/10"]}),(0,n.jsx)("input",{type:"range",min:"0",max:"10",value:g.support,onChange:e=>f(t=>({...t,support:Number(e.target.value)})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["子育て自信: ",g.confidence,"/10"]}),(0,n.jsx)("input",{type:"range",min:"0",max:"10",value:g.confidence,onChange:e=>f(t=>({...t,confidence:Number(e.target.value)})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),(0,n.jsx)("button",{type:"submit",disabled:h,className:"w-full bg-green-500 text-white py-2 px-4 rounded-md hover:bg-green-600 disabled:bg-gray-300",children:h?"送信中...":"研究を開始"})]})]}):(0,n.jsxs)("div",{className:"max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-md",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"研究参加同意"}),(0,n.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-md",children:[(0,n.jsx)("h3",{className:"font-semibold mb-2",children:"研究の目的"}),(0,n.jsx)("p",{className:"text-sm text-gray-700",children:"この研究は、AIアシスタントが母親の子育て支援にどのような効果があるかを調査することを目的としています。"})]}),(0,n.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-md",children:[(0,n.jsx)("h3",{className:"font-semibold mb-2",children:"参加内容"}),(0,n.jsxs)("ul",{className:"text-sm text-gray-700 space-y-1",children:[(0,n.jsx)("li",{children:"• 日次1分の気持ちチェック"}),(0,n.jsx)("li",{children:"• AIアシスタントとの対話"}),(0,n.jsx)("li",{children:"• 週次まとめの作成"}),(0,n.jsx)("li",{children:"• 簡単なアンケート（開始前・中間・終了後）"})]})]}),(0,n.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium mb-2",children:"お名前"}),(0,n.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),required:!0,className:"w-full p-2 border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium mb-2",children:"LINE連携"}),(0,n.jsx)("div",{className:"p-2 bg-green-50 border border-green-200 rounded-md text-sm text-green-700",children:e?"✅ LINE連携完了":"LINE連携中..."})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium mb-2",children:"参加コホート"}),(0,n.jsxs)("select",{value:u,onChange:e=>m(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md",children:[(0,n.jsx)("option",{value:"community",children:"コミュニティ参加者"}),(0,n.jsx)("option",{value:"general",children:"一般参加者"})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,n.jsx)("input",{type:"checkbox",id:"consent",checked:s,onChange:e=>o(e.target.checked),required:!0,className:"mt-1"}),(0,n.jsx)("label",{htmlFor:"consent",className:"text-sm",children:"上記の研究内容を理解し、データの使用に同意します。"})]}),(0,n.jsx)("button",{type:"submit",disabled:h||!s||!c||!e,className:"w-full bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed",children:h?"送信中...":"同意して参加"})]})]}):(0,n.jsx)("div",{className:"p-4 text-sm",children:"LINE連携中…"})}},4234:function(e,t,s){"use strict";s.d(t,{C:function(){return r},M:function(){return a}});var n=s(1571);async function a(e){try{console.log("[LIFF] Initializing with ID: ".concat(e)),n.Z.isLoggedIn()?console.log("[LIFF] Already logged in with ID: ".concat(e)):(await n.Z.init({liffId:e}),console.log("[LIFF] Successfully initialized with ID: ".concat(e)))}catch(t){throw console.error("[LIFF] Error initializing with ID ".concat(e,":"),t),t}}async function r(){try{let e=await n.Z.getProfile();return console.log("[LIFF] Got user profile: ".concat(e.userId)),e.userId}catch(e){throw console.error("[LIFF] Error getting user profile:",e),e}}}},function(e){e.O(0,[370,971,117,744],function(){return e(e.s=4920)}),_N_E=e.O()}]);